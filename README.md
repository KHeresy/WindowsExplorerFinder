# Windows Explorer Finder

> [!CAUTION]
> **⚠️ 警語：本專案之程式碼、文件與圖示完全由 Gemini-CLI 自動產生。**  
> 使用者應自行評估安全風險，作者不保證程式碼的絕對正確性與安全性。

這是一個強大的 Windows 檔案總管增強工具，提供即時搜尋並直接在原生檔案總管視窗中選取檔案的功能。

## 功能特色

*   **常駐執行 (Resident Mode)**：
    *   程式啟動後會縮小至系統匣 (System Tray)。
    *   支援單一執行實體 (Single Instance)，透過具名管道 (Named Pipe) 進行高效處理。
*   **全域快速鍵 (Global Hotkey)**：
    *   預設 `Ctrl + F3`。在檔案總管視窗中按下，可立即開啟搜尋介面。
    *   快速鍵可於設定中自定義。
*   **右鍵選單整合 (Shell Extension)**：
    *   原生整合於檔案總管右鍵選單「尋找檔案」。
    *   使用純 Win32 API 實作 DLL 插件，輕量且無負擔。
*   **進階搜尋與選取**：
    *   **雙向連動**：點兩下搜尋結果即可在檔案總管中選取；點擊「在檔案總管選取」可批次選取所有選中項。
    *   **多選支持**：支援選取全部、反向選取、全部取消。
    *   **預設自動全選**：可設定搜尋後自動選取所有結果。
*   **個人化設定**：
    *   **多國語言**：支援英文、繁體中文介面切換（需重啟生效）。
    *   **自動啟動**：支援隨 Windows 登入時自動執行。
    *   **最上層顯示**：保持搜尋視窗永遠在最前方。
    *   **選取後自動關閉**：執行選取動作後自動隱藏視窗。

## 系統需求

*   Windows 10 / 11 (64-bit)
*   Visual Studio 2026 (用於編譯)
*   Qt 6.10.1 (MSVC 2022 64-bit)

## 專案結構

*   **ExplorerPlugin** (DLL): Windows Shell Extension，負責右鍵選單邏輯。
*   **ExplorerFinder** (EXE): Qt 6 應用程式，負責搜尋介面、全域快速鍵與檔案總管控制。

## 編譯說明

1.  確保已安裝 Visual Studio 2026 與 Qt 6.10.1 (並包含 Network 模組)。
2.  開啟 `ExplorerFinder.slnx`。
3.  選擇 `Debug` 或 `Release` 設定，平台選擇 `x64`。
4.  建置方案 (Build Solution)。

## 安裝與使用

1.  **註冊右鍵選單**：
    以**系統管理員身分**執行：
    ```powershell
    regsvr32 "ExplorerPlugin.dll"
    ```
2.  **執行主程式**：
    執行 `ExplorerFinder.exe` 後，會在系統匣看到圖示。
3.  **開啟設定**：
    在系統匣圖示點擊滑鼠右鍵選擇 "Settings..."，或直接**連點兩下**圖示。
4.  **快速搜尋**：
    在檔案總管中按下 `Ctrl + F3` 或使用右鍵選單。

## 解除安裝

1.  以**系統管理員身分**執行：
    ```powershell
    regsvr32 /u "ExplorerPlugin.dll"
    ```
2.  若有開啟「自動啟動」，請先在設定中取消勾選。
3.  結束主程式後刪除檔案即可。

## 注意事項

*   搜尋支援萬用字元（例如輸入 `test` 會自動搜尋 `*test*`）。
*   本程式使用 `QLocalServer` 確保單一執行實體，若遇到無法啟動的情況，請檢查是否已有程序在背景執行。
